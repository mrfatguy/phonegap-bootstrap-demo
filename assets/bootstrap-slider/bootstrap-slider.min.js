/* =========================================================
 * bootstrap-slider.js v2.0.0
 * http://www.eyecon.ro/bootstrap-slider
 * =========================================================
 * Copyright 2012 Stefan Petre
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
!function(b){var a=function(e,o){this.element=b(e);var f=this.element.data("slider-handle")||o.handle;this.height=this.element.data("slider-height")||o.height;this.themed=this.element.data("slider-themed")||o.themed;this.trackClass=this.element.data("slider-track-class")||o.trackClass;this.handleClass=this.element.data("slider-handle-class")||o.handleClass;this.selectionClass=this.element.data("slider-selection-class")||o.selectionClass;this.trackOverflow=this.element.data("slider-track-overflow")||o.trackOverflow;var k=this.height,g=(f==="triangle"||f==="arrow")?0:this.height+10,h=(this.trackOverflow?"visible":"hidden"),c=((this.trackClass==="")?"progress":(this.trackClass==="btn")?"btn slider-track-reset":this.trackClass),d=(this.themed?c:"slider-track-default-color"),l=((this.handleClass==="")?"btn-primary":this.handleClass),m=(this.themed?l:"slider-handle-default-color"),i=((this.selectionClass==="")?"btn slider-track-reset":(this.selectionClass==="btn")?"btn slider-track-reset":this.selectionClass),j=(this.themed?i:"slider-selection-default-color");this.picker=b('<div class="slider"><div style="overflow: '+h+"; height: "+k+'px" class="slider-track '+d+'"><div style="height: '+k+'px" class="slider-selection '+j+'"></div><div style="height: '+g+"px; width: "+g+'px" class="slider-handle '+m+'"></div><div style="height: '+g+"px; width: "+g+'px" class="slider-handle '+m+'"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element);this.id=this.element.data("slider-id")||o.id;if(this.id){this.picker[0].id=this.id}if(typeof Modernizr!=="undefined"&&Modernizr.touch){this.touchCapable=true}var n=this.element.data("slider-tooltip")||o.tooltip;this.tooltip=this.picker.find(".tooltip");this.tooltipInner=this.tooltip.find("div.tooltip-inner");this.orientation=this.element.data("slider-orientation")||o.orientation;switch(this.orientation){case"vertical":this.picker.addClass("slider-vertical");this.stylePos="top";this.mousePos="pageY";this.sizePos="offsetHeight";this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal");this.orientation="horizontal";this.stylePos="left";this.mousePos="pageX";this.sizePos="offsetWidth";this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-30+"px";break}this.min=this.element.data("slider-min")||o.min;this.max=this.element.data("slider-max")||o.max;this.step=this.element.data("slider-step")||o.step;this.value=this.element.data("slider-value")||o.value;if(this.value[1]){this.range=true}this.selection=this.element.data("slider-selection")||o.selection;this.selectionEl=this.picker.find(".slider-selection");if(this.selection==="none"){this.selectionEl.addClass("hide")}this.selectionElStyle=this.selectionEl[0].style;this.handle1=this.picker.find(".slider-handle:first");this.handle1Stype=this.handle1[0].style;this.handle2=this.picker.find(".slider-handle:last");this.handle2Stype=this.handle2[0].style;switch(f){case"round":this.handle1.addClass("round");this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle");this.handle2.addClass("triangle");break;case"arrow":this.handle1.addClass("arrow");this.handle2.addClass("arrow");break}if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection=="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];this.formater=o.formater;if(this.touchCapable){this.picker.on({touchstart:b.proxy(this.mousedown,this)})}else{this.picker.on({mousedown:b.proxy(this.mousedown,this)})}if(n==="show"){this.picker.on({mouseenter:b.proxy(this.showTooltip,this),mouseleave:b.proxy(this.hideTooltip,this)})}else{this.tooltip.addClass("hide")}this.layout()};a.prototype={constructor:a,over:false,inDrag:false,showTooltip:function(){this.tooltip.addClass("in");this.over=true},hideTooltip:function(){if(this.inDrag===false){this.tooltip.removeClass("in")}this.over=false},layout:function(){this.handle1Stype[this.stylePos]=this.percentage[0]+"%";this.handle2Stype[this.stylePos]=this.percentage[1]+"%";if(this.orientation==="vertical"){this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%";this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"}else{this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%";this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%"}this.calculateValue();if(this.range){this.tooltipInner.text(this.formater(this.value[0])+" : "+this.formater(this.value[1]));this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}else{this.tooltipInner.text(this.formater(this.value[0]));this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}},mousedown:function(d){if(this.touchCapable&&d.type==="touchstart"){d=d.originalEvent}this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];console.log("mousedown: this.size = "+this.size);var c=this.getPercentage(d);if(this.range){var g=Math.abs(this.percentage[0]-c);var e=Math.abs(this.percentage[1]-c);this.dragged=(g<e)?0:1}else{this.dragged=0}this.percentage[this.dragged]=c;this.layout();if(this.touchCapable){b(document).on({touchmove:b.proxy(this.mousemove,this),touchend:b.proxy(this.mouseup,this)})}else{b(document).on({mousemove:b.proxy(this.mousemove,this),mouseup:b.proxy(this.mouseup,this)})}this.inDrag=true;var f=this.calculateValue();this.element.trigger({type:"slideStart",value:f}).trigger({type:"slide",value:f});return false},mousemove:function(d){if(this.touchCapable&&d.type==="touchmove"){d=d.originalEvent}var c=this.getPercentage(d);if(this.range){if(this.dragged===0&&this.percentage[1]<c){this.percentage[0]=this.percentage[1];this.dragged=1}else{if(this.dragged===1&&this.percentage[0]>c){this.percentage[1]=this.percentage[0];this.dragged=0}}}this.percentage[this.dragged]=c;this.layout();var e=this.calculateValue();this.element.trigger({type:"slide",value:e}).data("value",e).prop("value",e);return false},mouseup:function(c){if(this.touchCapable){b(document).off({touchmove:this.mousemove,touchend:this.mouseup})}else{b(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}this.inDrag=false;if(this.over==false){this.hideTooltip()}this.element;this.layout();var d=this.calculateValue();this.element.trigger({type:"slideStop",value:d}).data("value",d).prop("value",d);return false},calculateValue:function(){var c;if(this.range){c=[(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step),(this.min+Math.round((this.diff*this.percentage[1]/100)/this.step)*this.step)];this.value=c}else{c=(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step);this.value=[c,this.value[1]]}return c},getPercentage:function(d){if(this.touchCapable){d=d.touches[0]}var c=(d[this.mousePos]-this.offset[this.stylePos])*100/this.size;c=Math.round(c/this.percentage[2])*this.percentage[2];return Math.max(0,Math.min(100,c))},getValue:function(){if(this.range){return this.value}return this.value[0]},setValue:function(c){this.value=c;if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection=="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.layout()}};b.fn.slider=function(e,h){var d=null;var g=b(this),f=g.data("slider"),c=typeof e==="object"&&e;if(!f){d=g.data("slider",(f=new a(this,b.extend({},b.fn.slider.defaults,c))))}if(typeof e==="string"){d=f[e](h)}return d};b.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round",height:10,themed:false,trackClass:"",handleClass:"",selectionClass:"",trackOverflow:true,formater:function(c){return c}};b.fn.slider.Constructor=a}(window.jQuery);